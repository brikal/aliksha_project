<!DOCTYPE html>
<html>

<head>
    {% load static %}
    <title>{% block title %}Aliksha{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body>

    <div class="navbar">
        <!-- Left: Navigation Links -->
        <nav class="nav-links" aria-label="Main navigation">
            <div class="collections-dropdown">
                <a href="{% url 'all_collections' %}" class="dropdown-toggle" aria-expanded="false"
                    aria-haspopup="true">Collections</a>
                <div class="mega-menu">
                    <div class="mega-menu-wrapper">
                        <!-- Sidebar: List of Collections -->
                        <div class="mega-sidebar">
                            <h4>Collections</h4>
                            <ul>
                                {% for collection in footer_collections %}
                                <li><a href="{% url 'collections' collection.slug %}">{{ collection.name }}</a></li>
                                {% endfor %}
                                <li class="divider"></li>
                                <li><a href="{% url 'all_collections' %}" class="view-all">View All</a></li>
                            </ul>
                        </div>

                        <!-- Content: Image Grid -->
                        <div class="mega-content">
                            <div class="mega-grid">
                                {% for collection in footer_collections %}
                                <a href="{% url 'collections' collection.slug %}" class="mega-card">
                                    <div class="img-box">
                                        <img src="{% static collection.image %}" alt="{{ collection.name }}">
                                    </div>
                                    <span>{{ collection.name }}</span>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <a href="/about/">About</a>
            <a href="/contact/">Contact</a>
        </nav>

        <!-- Center: Brand Name -->
        <div class="brand-name">
            <a href="/">ALIKSHA</a>
        </div>

        <!-- Right: Icons -->
        <div class="navbar-right">
            <div class="nav-icons-group">
                <div class="nav-search-wrapper">
                    <button class="search-icon-btn" id="searchBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                    <div class="search-bar" id="searchBar">
                        <div class="search-input-wrapper">
                            <input type="text" class="search-input" id="searchInput" placeholder="Search products...">
                            <button class="search-close-btn" id="searchCloseBtn">×</button>
                        </div>
                        <div class="search-results" id="searchResults"></div>
                    </div>
                </div>
                <div class="nav-cart-wrapper">
                    <a href="/cart/" class="cart-link" id="cartBtn" aria-haspopup="dialog"
                        aria-controls="cartDrawer">
                        <svg class="cart-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                    </a>
                </div>
                <div class="nav-auth-wrapper">
                    {% if user.is_authenticated %}
                    <a href="{% url 'logout' %}" class="auth-icon-btn" title="Logout">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                    </a>
                    {% else %}
                    <button class="auth-icon-btn" id="authBtn" aria-haspopup="dialog" aria-controls="authModal"
                        title="Login / Signup">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M4 21v-2a4 4 0 0 1 3-3.87"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        {% block content %}
        {% endblock %}
    </div>

    <!-- Cart Drawer -->
    <div class="cart-drawer" id="cartDrawer" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="cart-drawer-backdrop" id="cartDrawerBackdrop"></div>
        <aside class="cart-drawer-panel" role="document" aria-label="Shopping cart">
            <div class="cart-drawer-header">
                <h3>My Bag</h3>
                <button class="cart-drawer-close" id="cartDrawerClose" aria-label="Close cart">&times;</button>
            </div>
            <div class="cart-drawer-body">
                {% if products %}
                <div class="cart-drawer-items">
                    {% for product in products %}
                    <div class="cart-drawer-item">
                        <div class="cart-drawer-thumb">
                            <img src="{{ product.image.url }}" alt="{{ product.name }}">
                        </div>
                        <div class="cart-drawer-info">
                            <h4>{{ product.name }}</h4>
                            <p class="cart-drawer-price">&#8377; {{ product.price }}</p>
                            <div class="cart-drawer-actions">
                                <div class="cart-qty" aria-label="Quantity selector">
                                    <button class="qty-btn" type="button" aria-label="Decrease quantity">-</button>
                                    <span class="qty-value">{{ product.quantity }}</span>
                                    <button class="qty-btn" type="button" aria-label="Increase quantity">+</button>
                                </div>
                                <a href="/remove-from-cart/{{ product.id }}/" class="cart-drawer-remove">Remove</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="cart-drawer-empty">Your bag is empty.</div>
                {% endif %}
            </div>
            {% if products %}
            <div class="cart-drawer-footer">
                <div class="cart-drawer-note">Taxes and shipping calculated at checkout.</div>
                <div class="cart-drawer-total">
                    <span>Total</span>
                    <strong>&#8377; {{ total|default:"0.00" }}</strong>
                </div>
                <a href="/cart/" class="cart-drawer-link">View cart</a>
                <a href="/checkout/" class="cart-drawer-checkout">Checkout</a>
            </div>
            {% endif %}
        </aside>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h4>Collections</h4>
                <ul>
                    {% for collection in footer_collections %}
                    <li><a href="{% url 'collections' collection.slug %}">{{ collection.name }}</a></li>
                    {% endfor %}
                </ul>
            </div>
            <div class="footer-column">
                <h4>About Us</h4>
                <ul>
                    <li><a href="/about/">About Us</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Social</h4>
                <ul>
                    <li><a href="https://www.youtube.com/channel/UCK_So3FWQ6lsP-5-s3wEi2Q" target="_blank"
                            rel="noopener noreferrer">YouTube</a></li>
                    <li><a href="https://www.instagram.com/alikshadresses/" target="_blank"
                            rel="noopener noreferrer">Instagram</a></li>
                    <li><a href="https://www.facebook.com/alikshadresses/" target="_blank"
                            rel="noopener noreferrer">Facebook</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Contact</h4>
                <ul>
                    <li><a href="/contact/">Contact Us</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 Aliksha. All rights reserved.</p>
        </div>
    </footer>


    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="auth-modal-backdrop" id="authBackdrop"></div>
        <div class="auth-modal-panel">
            <button class="auth-close" id="authClose" aria-label="Close modal">×</button>

            <div class="auth-forms">
                <!-- Login Form -->
                <form class="auth-form" id="loginForm" action="/auth/login/" method="POST">
                    {% csrf_token %}
                    <h3>Welcome Back</h3>
                    <div class="auth-error" id="loginError"></div>
                    <div class="form-group">
                        <label for="loginUsername">Username</label>
                        <input type="text" id="loginUsername" name="username" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" name="password" required
                            autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn">Sign In</button>
                    <div class="auth-switch">
                        Don't have an account?
                        <button type="button" class="link-like" id="showSignup">Sign up</button>
                    </div>
                </form>

                <!-- Signup Form -->
                <form class="auth-form" id="signupForm" action="/auth/signup/" method="POST" style="display: none;">
                    {% csrf_token %}
                    <h3>Create Account</h3>
                    <div class="auth-error" id="signupError"></div>
                    <div class="form-group">
                        <label for="signupUsername">Username</label>
                        <input type="text" id="signupUsername" name="username" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" name="email" required autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" name="password" required autocomplete="new-password">
                    </div>
                    <button type="submit" class="btn">Sign Up</button>
                    <div class="auth-switch">
                        Already have an account?
                        <button type="button" class="link-like" id="showLogin">Log in</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div id="toast-container" class="toast-container"></div>
    <script src="{% static 'js/main.js' %}"></script>

</body>

</html>
